# Web Request Capture Pro v2.1

## 🎯 主要功能

### 已完成功能
- ✅ **资源识别与黑名单模式**：默认支持所有资源类型下载，仅排除API、Ajax、WebSocket、CDN、统计、广告等不必要的资源类型
- ✅ **按域名+路径自动建目录**：导出时自动按照域名和实际路径创建目录结构，保持网站原有的文件组织结构
- ✅ **直接弹出文件夹选择器**：无需多余确认提示，点击导出后直接弹出文件夹选择器
- ✅ **批量导出资源**：支持一键导出所有筛选后的资源，支持文件夹选择
- ✅ **单个资源保存**：每个资源都有独立的"Save"按钮，点击后弹出文件夹选择器
- ✅ **实时下载状态**：表格显示每个资源的下载状态（Ready/Downloading/Downloaded/Failed/Excluded）
- ✅ **内存直接写入**：单个保存功能已实现从内存直接写入文件，无需重新下载

### 🔥 最新更新（v2.1）
- **直接内存写入**：点击"Save"按钮后，系统直接从内存中获取已缓存的资源数据并写入本地文件
- **实时状态更新**：保存过程中实时更新资源状态（Downloading → Downloaded/Failed）
- **智能文件处理**：支持文本和二进制文件的自动识别和正确保存
- **状态可视化**：不同状态使用不同颜色和动画效果区分

## 🚀 使用方法

### 1. 开始捕获
1. 在URL输入框中输入要分析的网站地址
2. 点击"Start Capture"开始捕获网络请求
3. 在新打开的浏览器窗口中浏览网站
4. 返回插件界面查看捕获的资源

### 2. 单个资源保存
1. 在资源列表中找到要保存的资源
2. 点击该行的"Save"按钮
3. 在弹出的文件夹选择器中选择保存位置
4. 系统自动创建域名/路径结构并保存文件
5. 查看状态列的实时更新（Downloading → Downloaded）

### 3. 批量导出资源
1. 使用筛选器选择需要的资源
2. 点击"Export Resources"按钮
3. 选择保存文件夹
4. 系统按域名和路径自动组织文件结构

## 📋 资源类型支持

### 支持的资源类型
- 🖼️ **图片文件**：JPG、PNG、GIF、WebP、SVG、BMP、ICO等
- 🎵 **音频文件**：MP3、WAV、OGG、AAC、FLAC等
- 🎬 **视频文件**：MP4、AVI、MOV、WebM、MKV等
- 📄 **文档文件**：PDF、DOC、XLS、PPT等
- 💻 **代码文件**：CSS、JS、JSON、XML、HTML等
- 🔠 **字体文件**：TTF、WOFF、WOFF2、EOT等
- 🎮 **游戏资源**：模型、纹理、音效等
- 📦 **压缩文件**：ZIP、RAR、7Z等

### 排除的资源类型（黑名单）
- ❌ **API接口**：/api/、/ajax/、/graphql等
- ❌ **统计追踪**：Google Analytics、广告追踪等
- ❌ **实时通信**：WebSocket、Socket.IO等
- ❌ **CDN服务**：Cloudflare CDN、RUM等
- ❌ **动态脚本**：带参数的PHP、ASP、JSP等

## 🛠️ 技术实现

### 内存直接写入机制
1. **资源捕获**：使用Chrome WebRequest API捕获网络请求
2. **数据获取**：通过fetch API从内存中获取已缓存的资源数据
3. **智能处理**：自动识别文本和二进制文件类型
4. **直接写入**：使用File System Access API直接写入本地文件系统

### 文件组织结构
```
选择的文件夹/
├── 域名1/
│   ├── 路径1/
│   │   ├── 文件1
│   │   └── 文件2
│   └── 路径2/
│       └── 文件3
├── 域名2/
│   └── 文件4
└── index.txt (资源索引文件)
```

## 📊 状态说明

| 状态 | 含义 | 颜色 |
|------|------|------|
| Ready | 可下载，等待用户操作 | 灰色 |
| Downloading | 正在下载中 | 蓝色（动画） |
| Downloaded | 下载完成 | 绿色 |
| Failed | 下载失败 | 红色 |
| N/A | 不支持下载的资源类型 | 灰色 |

## 🔧 开发者信息

- **版本**：v2.1
- **兼容性**：Chrome 90+
- **权限**：webRequest、downloads、storage、host_permissions
- **API使用**：File System Access API、Chrome Extensions API

## 📝 更新日志

### v2.1 (2024-06-23)
- 🎉 实现内存直接写入功能
- 🔄 优化下载状态实时更新
- 🎨 改进用户界面和状态显示
- 🐛 修复文件名生成和状态更新问题

### v2.0
- 🏗️ 重构资源识别逻辑（黑名单模式）
- 📁 实现按域名+路径自动建目录
- 🎯 优化用户体验，去除多余确认提示
- 📊 添加实时下载状态显示

## 🤝 贡献

欢迎提交issue和pull request来改进这个项目!
